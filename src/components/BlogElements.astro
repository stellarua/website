---
import PostCard from "../components/PostCard.astro";
import { getStaticPaths } from "../contentful/blogElements";
import type { BlogPost } from '../contentful/types';

const { paths } = await getStaticPaths();
const {lang} = Astro.params;

const currentLang = lang || 'en-US';
const postsArr: BlogPost['fields'][] = paths
  .filter((path:any) => path.params.locale === currentLang)
  .map((path:any) => path.props.post);

interface Props {
  arrLen?: number;
}

const { arrLen } = Astro.props;
const filteredPosts = arrLen ? postsArr.slice(0, arrLen) : postsArr;

---

{filteredPosts.map((entry:any) => {
    const { title, description, slug, photo } = entry;
    const imageUrl = photo?.fields?.file?.url || '';
  
    return (
      <PostCard
        image={imageUrl}
        title={title}
        link={lang ? `/${lang}/blog/${slug}` : `/blog/${slug}`}
        description={description}
      />
    );
  })}
